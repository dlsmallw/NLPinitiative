<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="ASU Capstone Group 8 / J Healthcare Initiative" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Dataset Management - NLPInitiative</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../style/style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Dataset Management";
        var mkdocs_page_input_path = "dataset-management.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> NLPInitiative
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">User Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/Data_Import_Notes/">Data Importing and Normalization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/Data_Processing/">Data Preprocessing and Tokenization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/Model_Training/">Model Training, Evaluation and Deployment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/Inference_Demo/">Model Inference</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Module Documentation</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Dataset Management</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management">data_management</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DataManager">DataManager</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DataManager.__init__">__init__</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DataManager.build_master_dataset">build_master_dataset</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DataManager.file_to_df">file_to_df</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DataManager.get_dataset_statistics">get_dataset_statistics</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DataManager.import_data">import_data</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DataManager.normalize_dataset">normalize_dataset</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DataManager.prepare_and_preprocess_dataset">prepare_and_preprocess_dataset</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DataManager.pull_dataset_repo">pull_dataset_repo</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DataManager.push_dataset_dir">push_dataset_dir</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DataManager.remove_file">remove_file</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetContainer">DatasetContainer</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetContainer.encoded_dataset">encoded_dataset</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetContainer.idx2lbl">idx2lbl</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetContainer.labels">labels</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetContainer.lbl2idx">lbl2idx</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetContainer.raw_dataset">raw_dataset</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetContainer.tokenizer">tokenizer</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetContainer.__init__">__init__</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetRecordManager">DatasetRecordManager</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetRecordManager.__init__">__init__</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetRecordManager.dataset_src_exists">dataset_src_exists</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetRecordManager.get_ds_record_copy">get_ds_record_copy</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetRecordManager.get_entry_by_raw_fn">get_entry_by_raw_fn</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetRecordManager.load_dataset_record">load_dataset_record</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetRecordManager.remove_entry">remove_entry</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetRecordManager.save_ds_record">save_ds_record</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_management.DatasetRecordManager.update">update</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#nlpinitiative.data_preparation.data_normalize">data_normalize</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#nlpinitiative.data_preparation.data_normalize.DataNormalizer">DataNormalizer</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_normalize.DataNormalizer.normalize_datasets">normalize_datasets</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#nlpinitiative.data_preparation.data_process">data_process</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#nlpinitiative.data_preparation.data_process.DataProcessor">DataProcessor</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_process.DataProcessor.bin_ml_dataset_split">bin_ml_dataset_split</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_process.DataProcessor.dataset_from_file">dataset_from_file</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_process.DataProcessor.get_dataset_metadata">get_dataset_metadata</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_process.DataProcessor.get_tokenizer">get_tokenizer</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#nlpinitiative.data_preparation.data_process.DataProcessor.preprocess">preprocess</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../model-management/">Model Training, Evaluation and Inference</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">NLPInitiative</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Module Documentation</li>
      <li class="breadcrumb-item active">Dataset Management</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="dataset-operations">Dataset Operations</h1>
<hr />


<div class="doc doc-object doc-module">



<h2 id="nlpinitiative.data_preparation.data_management" class="doc doc-heading">
            <code>nlpinitiative.data_preparation.data_management</code>


</h2>

    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="nlpinitiative.data_preparation.data_management.DataManager" class="doc doc-heading">
            <code>DataManager</code>


</h3>


    <div class="doc doc-contents ">


        <p>A class for handling data import, normalization and preprocessing/tokenization.</p>







              <details class="quote">
                <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DataManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class for handling data import, normalization and preprocessing/tokenization.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Contructor method for instantiating a DataManager object.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">normalizer</span> <span class="o">=</span> <span class="n">DataNormalizer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processor</span> <span class="o">=</span> <span class="n">DataProcessor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rec_mgr</span> <span class="o">=</span> <span class="n">DatasetRecordManager</span><span class="p">()</span>

    <span class="c1"># Data Importing Functionality</span>
    <span class="c1"># ===================================================================================================================</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_is_valid_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks that a URL has a valid format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        url : str</span>
<span class="sd">            The url to be checked.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the URL valid or False if not.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">url</span><span class="p">:</span>
            <span class="n">parsed_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">parsed_url</span><span class="o">.</span><span class="n">scheme</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;http&quot;</span><span class="p">,</span> <span class="s2">&quot;https&quot;</span><span class="p">,</span> <span class="s2">&quot;ftp&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_import_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates a filename that will be used when importing new datasets.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        url : str</span>
<span class="sd">            The url of the dataset to be imported.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The generated file name.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">github</span><span class="p">():</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Generates a filename based on a GitHub URL.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            str</span>
<span class="sd">                The generated file name.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">parsed</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">parsed</span><span class="o">.</span><span class="n">path</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">path_arr</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">path_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">path_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">path_arr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

        <span class="k">if</span> <span class="s2">&quot;github&quot;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">github</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">split_arr</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">split_arr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts URLs to a format that can be used for importing data from a remote source.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        url : str</span>
<span class="sd">            The url of the dataset to be imported.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The reformatted URL.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">github</span><span class="p">():</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Handles conversion of GitHub URLs.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            str</span>
<span class="sd">                The reformatted GitHub URL.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com&quot;</span>
            <span class="k">if</span> <span class="n">base_url</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">url</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">updated_url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;https://github.com&quot;</span><span class="p">,</span> <span class="n">base_url</span><span class="p">)</span>
                <span class="n">updated_url</span> <span class="o">=</span> <span class="n">updated_url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;blob&quot;</span><span class="p">,</span> <span class="s2">&quot;refs/heads&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">updated_url</span>

        <span class="k">if</span> <span class="s2">&quot;github&quot;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Source url identified as GitHub URL, </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">formatted_url</span> <span class="o">=</span> <span class="n">github</span><span class="p">()</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;URL Formatted, </span><span class="si">{</span><span class="n">formatted_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">formatted_url</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">url</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">file_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ext</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts a dataset to a dataframe.</span>

<span class="sd">        This function also handles conversion of csv files with atypical delimiters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        source : str</span>
<span class="sd">            The file path for a local dataset or URL for a remote dataset.</span>
<span class="sd">        ext : str</span>
<span class="sd">            The file extension of the dataset.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DataFrame</span>
<span class="sd">            The dataset as a Pandas DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">match</span> <span class="n">ext</span><span class="p">:</span>
                <span class="k">case</span> <span class="s2">&quot;.csv&quot;</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
                <span class="k">case</span> <span class="s2">&quot;.xlsx&quot;</span><span class="p">:</span>
                    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
                <span class="k">case</span> <span class="s2">&quot;.json&quot;</span><span class="p">:</span>
                    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
                <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                    <span class="n">df</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="n">df</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">err_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to import from source - </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">import_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">import_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">source</span><span class="p">,</span>
        <span class="n">dataset_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">is_third_party</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">local_ds_ref_url</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports data from a local (by file path) or remote (ny URL) source.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        import_type : str</span>
<span class="sd">            &#39;local&#39; if from a local source, &#39;external&#39; if from remote source.</span>
<span class="sd">        source : str</span>
<span class="sd">            The file path or URL of the dataset.</span>
<span class="sd">        dataset_name : str</span>
<span class="sd">            The name used to id the dataset.</span>
<span class="sd">        is_third_party : bool, optional</span>
<span class="sd">            True if 3rd party dataset, False if not (default is True).</span>
<span class="sd">        local_ds_ref_url : str, optional</span>
<span class="sd">            Reference URL for datasets imported locally (default is None).</span>
<span class="sd">        overwrite : bool, optional</span>
<span class="sd">            True if files with the same name should be overwritten, False if not (default is False).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DataFrame</span>
<span class="sd">            The dataset as a Pandas DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ref_url</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">formatted_url</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">match</span> <span class="n">import_type</span><span class="p">:</span>
            <span class="k">case</span> <span class="s2">&quot;local&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
                    <span class="n">err_msg</span> <span class="o">=</span> <span class="s2">&quot;Dataset filepath does not exist&quot;</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">is_third_party</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_valid_url</span><span class="p">(</span><span class="n">local_ds_ref_url</span><span class="p">):</span>
                    <span class="n">err_msg</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="s2">&quot;Locally imported 3rd party dataset imports must include a reference URL.&quot;</span>
                    <span class="p">)</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

                <span class="n">ref_url</span> <span class="o">=</span> <span class="n">local_ds_ref_url</span> <span class="k">if</span> <span class="n">is_third_party</span> <span class="k">else</span> <span class="s2">&quot;Custom Created Dataset&quot;</span>

                <span class="n">tail</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">source</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">filename</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">tail</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>

                <span class="k">if</span> <span class="n">ext</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ACCEPTED_FILE_FORMATS</span><span class="p">:</span>
                    <span class="n">err_msg</span> <span class="o">=</span> <span class="s2">&quot;Unsupported file type&quot;</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

                <span class="n">src</span> <span class="o">=</span> <span class="n">source</span>
            <span class="k">case</span> <span class="s2">&quot;external&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_valid_url</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
                    <span class="n">err_msg</span> <span class="o">=</span> <span class="s2">&quot;Invalid URL&quot;</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

                <span class="n">ref_url</span> <span class="o">=</span> <span class="n">source</span>
                <span class="n">formatted_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_url</span><span class="p">(</span><span class="n">ref_url</span><span class="p">)</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_import_filename</span><span class="p">(</span><span class="n">formatted_url</span><span class="p">)</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">formatted_url</span><span class="p">)</span><span class="o">.</span><span class="n">path</span>
                <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">ext</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ACCEPTED_FILE_FORMATS</span><span class="p">:</span>
                    <span class="n">err_msg</span> <span class="o">=</span> <span class="s2">&quot;Unsupported file type&quot;</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

                <span class="n">src</span> <span class="o">=</span> <span class="n">formatted_url</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="n">err_msg</span> <span class="o">=</span> <span class="s2">&quot;Invalid import type&quot;</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

        <span class="n">ds_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_to_df</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_mgr</span><span class="o">.</span><span class="n">dataset_src_exists</span><span class="p">(</span><span class="n">ref_url</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">ds_df</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_store_data</span><span class="p">(</span>
            <span class="n">data_df</span><span class="o">=</span><span class="n">ds_df</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">destpath</span><span class="o">=</span><span class="n">RAW_DATA_DIR</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rec_mgr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="n">ds_id</span><span class="o">=</span><span class="n">dataset_name</span><span class="p">,</span>
            <span class="n">src_url</span><span class="o">=</span><span class="n">ref_url</span><span class="p">,</span>
            <span class="n">download_url</span><span class="o">=</span><span class="n">formatted_url</span><span class="p">,</span>
            <span class="n">raw_ds_filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully imported </span><span class="si">{</span><span class="n">import_type</span><span class="si">}</span><span class="s2"> dataset from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ds_df</span>

    <span class="c1"># Data Normalization Functionality</span>
    <span class="c1"># ===================================================================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_valid_filepath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks that the specified file path is valid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : Path</span>
<span class="sd">            The file path to be checked.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if it exists, False if it does not.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">normalize_dataset</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ds_files</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">conv_schema_fn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_fn</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handles normalization of a third-party dataset to the schema used for training our models.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ds_files : list[str]</span>
<span class="sd">            One or more dataset files to merge and normalize.</span>
<span class="sd">        conv_schema_fn : str</span>
<span class="sd">            The file name of the json conversion schema used.</span>
<span class="sd">        output_fn : str</span>
<span class="sd">            The output filename to be used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DataFrame</span>
<span class="sd">            True if it exists, False if it does not.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">ds_files</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_filepath</span><span class="p">((</span><span class="n">RAW_DATA_DIR</span> <span class="o">/</span> <span class="n">filename</span><span class="p">)):</span>
                <span class="n">err_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid filepath for file, </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">RAW_DATA_DIR</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">filename</span><span class="si">}</span><span class="s2">].&quot;</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_filepath</span><span class="p">(</span><span class="n">NORM_SCHEMA_DIR</span> <span class="o">/</span> <span class="n">conv_schema_fn</span><span class="p">):</span>
            <span class="n">err_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Normalization schema file, </span><span class="si">{</span><span class="n">conv_schema_fn</span><span class="si">}</span><span class="s2">, does not exist.&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">output_fn</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_fn</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">err_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid output filename&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">normalized_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalizer</span><span class="o">.</span><span class="n">normalize_datasets</span><span class="p">(</span>
                <span class="n">files</span><span class="o">=</span><span class="n">ds_files</span><span class="p">,</span> <span class="n">cv_path</span><span class="o">=</span><span class="n">NORM_SCHEMA_DIR</span> <span class="o">/</span> <span class="n">conv_schema_fn</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">err_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to normalize file(s) - </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_store_data</span><span class="p">(</span><span class="n">normalized_df</span><span class="p">,</span> <span class="n">output_fn</span><span class="p">,</span> <span class="n">INTERIM_DATA_DIR</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">ds_files</span><span class="p">:</span>
            <span class="n">row_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_mgr</span><span class="o">.</span><span class="n">get_entry_by_raw_fn</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rec_mgr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="n">ds_id</span><span class="o">=</span><span class="n">row_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">src_url</span><span class="o">=</span><span class="n">row_vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">download_url</span><span class="o">=</span><span class="n">row_vals</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">raw_ds_filename</span><span class="o">=</span><span class="n">row_vals</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                <span class="n">normalization_schema_filename</span><span class="o">=</span><span class="n">conv_schema_fn</span><span class="p">,</span>
                <span class="n">normalized_ds_filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_fn</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully normalized dataset files [</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ds_files</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">normalized_df</span>

    <span class="c1"># Master Dataset Creation</span>
    <span class="c1"># ===================================================================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build_master_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Takes the processed datasets, merges them and then stores the resulting dataset in the data/processed directory.</span>

<span class="sd">        Facilitates consolidation of all imported and normalized datasets into a single, master dataset and</span>
<span class="sd">        stores the master dataset in the data/processed directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">master_df</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">INTERIM_DATA_DIR</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="s2">&quot;.gitkeep&quot;</span><span class="p">:</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="n">new_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_to_df</span><span class="p">(</span><span class="n">INTERIM_DATA_DIR</span> <span class="o">/</span> <span class="n">filename</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">master_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">master_df</span> <span class="o">=</span> <span class="n">new_df</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">master_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">master_df</span><span class="p">,</span> <span class="n">new_df</span><span class="p">])</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_store_data</span><span class="p">(</span>
            <span class="n">data_df</span><span class="o">=</span><span class="n">master_df</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;NLPinitiative_Master_Dataset&quot;</span><span class="p">,</span>
            <span class="n">destpath</span><span class="o">=</span><span class="n">PROCESSED_DATA_DIR</span><span class="p">,</span>
            <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pull_dataset_repo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pulls the data directory from the linked Hugging Face Dataset Repository.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        token : str</span>
<span class="sd">            A Hugging Face token with read/write access privileges to allow importing the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hfh</span><span class="o">.</span><span class="n">snapshot_download</span><span class="p">(</span>
                <span class="n">repo_id</span><span class="o">=</span><span class="n">DATASET_REPO</span><span class="p">,</span> <span class="n">repo_type</span><span class="o">=</span><span class="s2">&quot;dataset&quot;</span><span class="p">,</span> <span class="n">local_dir</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">token</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">push_dataset_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pushes the data directory (all dataset information) to the linked Hugging Face Dataset Repository.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        token : str</span>
<span class="sd">            A Hugging Face token with read/write access privileges to allow importing the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hfh</span><span class="o">.</span><span class="n">upload_folder</span><span class="p">(</span>
                <span class="n">repo_id</span><span class="o">=</span><span class="n">DATASET_REPO</span><span class="p">,</span> <span class="n">repo_type</span><span class="o">=</span><span class="s2">&quot;dataset&quot;</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">token</span>
            <span class="p">)</span>

    <span class="c1"># Data Preparation Functionality</span>
    <span class="c1"># ===================================================================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_and_preprocess_dataset</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;NLPinitiative_Master_Dataset.csv&quot;</span><span class="p">,</span>
        <span class="n">srcdir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">PROCESSED_DATA_DIR</span><span class="p">,</span>
        <span class="n">bin_model_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEF_MODEL</span><span class="p">,</span>
        <span class="n">ml_model_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEF_MODEL</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Preprocesses and tokenizes the specified dataset.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str, optional</span>
<span class="sd">            The file name of the file to be loaded and processed (default is &#39;NLPinitiative_Master_Dataset.csv&#39;).</span>
<span class="sd">        srcdir : Path, optional</span>
<span class="sd">            The source directory of the file to be processed (default is data/processed).</span>
<span class="sd">        bin_model_type : str, optional</span>
<span class="sd">            The binary classification base model type (default is the DEF_MODEL defined in the nlpinitiative/config.py file).</span>
<span class="sd">        ml_model_type : str, optional</span>
<span class="sd">            The multilabel regression base model type (default is the DEF_MODEL defined in the nlpinitiative/config.py file).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple[DatasetContainer, DatasetContainer]</span>
<span class="sd">            Two data container objects consisting of the raw dataset, encoded dataset, metadata and tokenizer for training binary and multilabel models.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">raw_dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">dataset_from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">srcdir</span><span class="p">)</span>
        <span class="n">bin_ds</span><span class="p">,</span> <span class="n">ml_ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">bin_ml_dataset_split</span><span class="p">(</span><span class="n">raw_dataset</span><span class="p">)</span>

        <span class="n">bin_ds_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">get_dataset_metadata</span><span class="p">(</span><span class="n">bin_ds</span><span class="p">)</span>
        <span class="n">bin_tkzr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">get_tokenizer</span><span class="p">(</span><span class="n">bin_model_type</span><span class="p">)</span>
        <span class="n">bin_encoded_ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">bin_ds</span><span class="p">,</span> <span class="n">bin_ds_metadata</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">],</span> <span class="n">bin_tkzr</span><span class="p">)</span>
        <span class="n">bin_data_obj</span> <span class="o">=</span> <span class="n">DatasetContainer</span><span class="p">(</span><span class="n">bin_ds</span><span class="p">,</span> <span class="n">bin_encoded_ds</span><span class="p">,</span> <span class="n">bin_ds_metadata</span><span class="p">,</span> <span class="n">bin_tkzr</span><span class="p">)</span>

        <span class="n">ml_ds_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">get_dataset_metadata</span><span class="p">(</span><span class="n">bin_ds</span><span class="p">)</span>
        <span class="n">ml_tkzr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">get_tokenizer</span><span class="p">(</span><span class="n">ml_model_type</span><span class="p">)</span>
        <span class="n">ml_encoded_ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">ml_ds</span><span class="p">,</span> <span class="n">ml_ds_metadata</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">],</span> <span class="n">ml_tkzr</span><span class="p">)</span>
        <span class="n">ml_data_obj</span> <span class="o">=</span> <span class="n">DatasetContainer</span><span class="p">(</span><span class="n">ml_ds</span><span class="p">,</span> <span class="n">ml_encoded_ds</span><span class="p">,</span> <span class="n">ml_ds_metadata</span><span class="p">,</span> <span class="n">ml_tkzr</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">bin_data_obj</span><span class="p">,</span> <span class="n">ml_data_obj</span>

    <span class="c1"># Misc Helper Functions</span>
    <span class="c1"># ===================================================================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_store_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">data_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">destpath</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stores the specified DataFrame as a csv dataset within the data directory.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data_df : DataFrame</span>
<span class="sd">            The dataset as a Pandas DataFrame object.</span>
<span class="sd">        filename : str</span>
<span class="sd">            The file name of the data to be stored.</span>
<span class="sd">        destpath : Path</span>
<span class="sd">            The path that the data is to be stored at.</span>
<span class="sd">        overwrite : bool, optional</span>
<span class="sd">            True if file with the same name should be overwritten, False if not (default is False).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">## Handles situations of duplicate filenames</span>
        <span class="n">appended_num</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">corrected_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.csv&quot;</span>

        <span class="k">while</span> <span class="ow">not</span> <span class="n">overwrite</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">destpath</span><span class="p">,</span> <span class="n">corrected_filename</span><span class="p">)):</span>
            <span class="n">appended_num</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">corrected_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">appended_num</span><span class="si">}</span><span class="s2">.csv&quot;</span>
        <span class="n">data_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
            <span class="n">path_or_buf</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">destpath</span><span class="p">,</span> <span class="n">corrected_filename</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_dataset_statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates statistics for the specified dataset.</span>

<span class="sd">        Evaluates a dataset and records various details for use in assesing if the dataset is imbalanced.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ds_path : Path</span>
<span class="sd">            The file path to the dataset.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            A JSON object containing the generated data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">get_category_details</span><span class="p">():</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Generates statistical data for the category columns of the dataset.</span>

<span class="sd">            Evaluations include:</span>
<span class="sd">                - The sum of the categories values.</span>
<span class="sd">                - The number of rows that a given category has a non-zero value.</span>
<span class="sd">                - The number of rows where the category has a value greater than 0.5.</span>
<span class="sd">                - The number of rows where the category had the highest value among categories.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            dict</span>
<span class="sd">                A dict containing the data for all categories.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">cat_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">CATEGORY_LABELS</span><span class="p">:</span>
                <span class="n">cat_dict</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;total_combined_value&quot;</span><span class="p">:</span> <span class="n">dataset_df</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
                    <span class="s2">&quot;num_positive_rows&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataset_df</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]),</span>
                    <span class="s2">&quot;num_gt_threshold&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataset_df</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">]),</span>
                    <span class="s2">&quot;num_rows_as_dominant_category&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="p">}</span>

            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dataset_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="n">dominant_cat</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">dominant_val</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">CATEGORY_LABELS</span><span class="p">:</span>
                    <span class="n">cat_val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">cat_val</span> <span class="o">&gt;</span> <span class="n">dominant_val</span><span class="p">:</span>
                        <span class="n">dominant_cat</span> <span class="o">=</span> <span class="n">cat</span>
                        <span class="n">dominant_val</span> <span class="o">=</span> <span class="n">cat_val</span>
                <span class="k">if</span> <span class="n">dominant_cat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cat_dict</span><span class="p">[</span><span class="n">dominant_cat</span><span class="p">][</span><span class="s2">&quot;num_rows_as_dominant_category&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">cat_dict</span>

        <span class="n">dataset_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_to_df</span><span class="p">(</span><span class="n">ds_path</span><span class="p">,</span> <span class="s2">&quot;.csv&quot;</span><span class="p">)</span>

        <span class="n">json_obj</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;total_num_entries&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_df</span><span class="p">),</span>
            <span class="s2">&quot;num_positive_discriminatory&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataset_df</span><span class="p">[</span><span class="n">BINARY_LABELS</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]),</span>
            <span class="s2">&quot;num_negative_discriminatory&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataset_df</span><span class="p">[</span><span class="n">BINARY_LABELS</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]),</span>
            <span class="s2">&quot;category_stats&quot;</span><span class="p">:</span> <span class="n">get_category_details</span><span class="p">(),</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">json_obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes the specified file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str</span>
<span class="sd">            The name of the file.</span>
<span class="sd">        path : Path</span>
<span class="sd">            The path to the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="n">filename</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="n">filename</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully removed file, </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to remove file, </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File, </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">, does not exist.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DataManager.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Contructor method for instantiating a DataManager object.</p>


            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Contructor method for instantiating a DataManager object.&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">normalizer</span> <span class="o">=</span> <span class="n">DataNormalizer</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">processor</span> <span class="o">=</span> <span class="n">DataProcessor</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rec_mgr</span> <span class="o">=</span> <span class="n">DatasetRecordManager</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DataManager.build_master_dataset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_master_dataset</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Takes the processed datasets, merges them and then stores the resulting dataset in the data/processed directory.</p>
<p>Facilitates consolidation of all imported and normalized datasets into a single, master dataset and
stores the master dataset in the data/processed directory.</p>


            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_master_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Takes the processed datasets, merges them and then stores the resulting dataset in the data/processed directory.</span>

<span class="sd">    Facilitates consolidation of all imported and normalized datasets into a single, master dataset and</span>
<span class="sd">    stores the master dataset in the data/processed directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">master_df</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">INTERIM_DATA_DIR</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="s2">&quot;.gitkeep&quot;</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">new_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_to_df</span><span class="p">(</span><span class="n">INTERIM_DATA_DIR</span> <span class="o">/</span> <span class="n">filename</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">master_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">master_df</span> <span class="o">=</span> <span class="n">new_df</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">master_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">master_df</span><span class="p">,</span> <span class="n">new_df</span><span class="p">])</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_store_data</span><span class="p">(</span>
        <span class="n">data_df</span><span class="o">=</span><span class="n">master_df</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;NLPinitiative_Master_Dataset&quot;</span><span class="p">,</span>
        <span class="n">destpath</span><span class="o">=</span><span class="n">PROCESSED_DATA_DIR</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DataManager.file_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">file_to_df</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Converts a dataset to a dataframe.</p>
<p>This function also handles conversion of csv files with atypical delimiters.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>source</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>The file path for a local dataset or URL for a remote dataset.</p>
              </div>
            </li>
            <li>
              <b><code>ext</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>The file extension of the dataset.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="DataFrame">DataFrame</span></code>
              
              <div class="doc-md-description">
                <p>The dataset as a Pandas DataFrame.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">file_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ext</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a dataset to a dataframe.</span>

<span class="sd">    This function also handles conversion of csv files with atypical delimiters.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    source : str</span>
<span class="sd">        The file path for a local dataset or URL for a remote dataset.</span>
<span class="sd">    ext : str</span>
<span class="sd">        The file extension of the dataset.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DataFrame</span>
<span class="sd">        The dataset as a Pandas DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">match</span> <span class="n">ext</span><span class="p">:</span>
            <span class="k">case</span> <span class="s2">&quot;.csv&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="s2">&quot;.xlsx&quot;</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
            <span class="k">case</span> <span class="s2">&quot;.json&quot;</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">df</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">err_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to import from source - </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DataManager.get_dataset_statistics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_dataset_statistics</span><span class="p">(</span><span class="n">ds_path</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generates statistics for the specified dataset.</p>
<p>Evaluates a dataset and records various details for use in assesing if the dataset is imbalanced.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>ds_path</code></b>
                  (<code><span title="pathlib.Path">Path</span></code>)
              
              <div class="doc-md-description">
                <p>The file path to the dataset.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="dict">dict</span></code>
              
              <div class="doc-md-description">
                <p>A JSON object containing the generated data.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_dataset_statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates statistics for the specified dataset.</span>

<span class="sd">    Evaluates a dataset and records various details for use in assesing if the dataset is imbalanced.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ds_path : Path</span>
<span class="sd">        The file path to the dataset.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        A JSON object containing the generated data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_category_details</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates statistical data for the category columns of the dataset.</span>

<span class="sd">        Evaluations include:</span>
<span class="sd">            - The sum of the categories values.</span>
<span class="sd">            - The number of rows that a given category has a non-zero value.</span>
<span class="sd">            - The number of rows where the category has a value greater than 0.5.</span>
<span class="sd">            - The number of rows where the category had the highest value among categories.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            A dict containing the data for all categories.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cat_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">CATEGORY_LABELS</span><span class="p">:</span>
            <span class="n">cat_dict</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;total_combined_value&quot;</span><span class="p">:</span> <span class="n">dataset_df</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
                <span class="s2">&quot;num_positive_rows&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataset_df</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]),</span>
                <span class="s2">&quot;num_gt_threshold&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataset_df</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">]),</span>
                <span class="s2">&quot;num_rows_as_dominant_category&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">}</span>

        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dataset_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">dominant_cat</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">dominant_val</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">CATEGORY_LABELS</span><span class="p">:</span>
                <span class="n">cat_val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">cat_val</span> <span class="o">&gt;</span> <span class="n">dominant_val</span><span class="p">:</span>
                    <span class="n">dominant_cat</span> <span class="o">=</span> <span class="n">cat</span>
                    <span class="n">dominant_val</span> <span class="o">=</span> <span class="n">cat_val</span>
            <span class="k">if</span> <span class="n">dominant_cat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cat_dict</span><span class="p">[</span><span class="n">dominant_cat</span><span class="p">][</span><span class="s2">&quot;num_rows_as_dominant_category&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">cat_dict</span>

    <span class="n">dataset_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_to_df</span><span class="p">(</span><span class="n">ds_path</span><span class="p">,</span> <span class="s2">&quot;.csv&quot;</span><span class="p">)</span>

    <span class="n">json_obj</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;total_num_entries&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_df</span><span class="p">),</span>
        <span class="s2">&quot;num_positive_discriminatory&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataset_df</span><span class="p">[</span><span class="n">BINARY_LABELS</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]),</span>
        <span class="s2">&quot;num_negative_discriminatory&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataset_df</span><span class="p">[</span><span class="n">BINARY_LABELS</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]),</span>
        <span class="s2">&quot;category_stats&quot;</span><span class="p">:</span> <span class="n">get_category_details</span><span class="p">(),</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">json_obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DataManager.import_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">import_data</span><span class="p">(</span><span class="n">import_type</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">is_third_party</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">local_ds_ref_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Imports data from a local (by file path) or remote (ny URL) source.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>import_type</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>'local' if from a local source, 'external' if from remote source.</p>
              </div>
            </li>
            <li>
              <b><code>source</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>The file path or URL of the dataset.</p>
              </div>
            </li>
            <li>
              <b><code>dataset_name</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>The name used to id the dataset.</p>
              </div>
            </li>
            <li>
              <b><code>is_third_party</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              
              <div class="doc-md-description">
                <p>True if 3rd party dataset, False if not (default is True).</p>
              </div>
            </li>
            <li>
              <b><code>local_ds_ref_url</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>None</code>
)
              
              <div class="doc-md-description">
                <p>Reference URL for datasets imported locally (default is None).</p>
              </div>
            </li>
            <li>
              <b><code>overwrite</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              
              <div class="doc-md-description">
                <p>True if files with the same name should be overwritten, False if not (default is False).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="DataFrame">DataFrame</span></code>
              
              <div class="doc-md-description">
                <p>The dataset as a Pandas DataFrame.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">import_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">import_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">source</span><span class="p">,</span>
    <span class="n">dataset_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">is_third_party</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">local_ds_ref_url</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Imports data from a local (by file path) or remote (ny URL) source.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    import_type : str</span>
<span class="sd">        &#39;local&#39; if from a local source, &#39;external&#39; if from remote source.</span>
<span class="sd">    source : str</span>
<span class="sd">        The file path or URL of the dataset.</span>
<span class="sd">    dataset_name : str</span>
<span class="sd">        The name used to id the dataset.</span>
<span class="sd">    is_third_party : bool, optional</span>
<span class="sd">        True if 3rd party dataset, False if not (default is True).</span>
<span class="sd">    local_ds_ref_url : str, optional</span>
<span class="sd">        Reference URL for datasets imported locally (default is None).</span>
<span class="sd">    overwrite : bool, optional</span>
<span class="sd">        True if files with the same name should be overwritten, False if not (default is False).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DataFrame</span>
<span class="sd">        The dataset as a Pandas DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ref_url</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">formatted_url</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">match</span> <span class="n">import_type</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;local&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
                <span class="n">err_msg</span> <span class="o">=</span> <span class="s2">&quot;Dataset filepath does not exist&quot;</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">is_third_party</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_valid_url</span><span class="p">(</span><span class="n">local_ds_ref_url</span><span class="p">):</span>
                <span class="n">err_msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;Locally imported 3rd party dataset imports must include a reference URL.&quot;</span>
                <span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

            <span class="n">ref_url</span> <span class="o">=</span> <span class="n">local_ds_ref_url</span> <span class="k">if</span> <span class="n">is_third_party</span> <span class="k">else</span> <span class="s2">&quot;Custom Created Dataset&quot;</span>

            <span class="n">tail</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">source</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">filename</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">tail</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>

            <span class="k">if</span> <span class="n">ext</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ACCEPTED_FILE_FORMATS</span><span class="p">:</span>
                <span class="n">err_msg</span> <span class="o">=</span> <span class="s2">&quot;Unsupported file type&quot;</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

            <span class="n">src</span> <span class="o">=</span> <span class="n">source</span>
        <span class="k">case</span> <span class="s2">&quot;external&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_valid_url</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
                <span class="n">err_msg</span> <span class="o">=</span> <span class="s2">&quot;Invalid URL&quot;</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

            <span class="n">ref_url</span> <span class="o">=</span> <span class="n">source</span>
            <span class="n">formatted_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_url</span><span class="p">(</span><span class="n">ref_url</span><span class="p">)</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_import_filename</span><span class="p">(</span><span class="n">formatted_url</span><span class="p">)</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">formatted_url</span><span class="p">)</span><span class="o">.</span><span class="n">path</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">ext</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ACCEPTED_FILE_FORMATS</span><span class="p">:</span>
                <span class="n">err_msg</span> <span class="o">=</span> <span class="s2">&quot;Unsupported file type&quot;</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

            <span class="n">src</span> <span class="o">=</span> <span class="n">formatted_url</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="n">err_msg</span> <span class="o">=</span> <span class="s2">&quot;Invalid import type&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

    <span class="n">ds_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_to_df</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_mgr</span><span class="o">.</span><span class="n">dataset_src_exists</span><span class="p">(</span><span class="n">ref_url</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ds_df</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_store_data</span><span class="p">(</span>
        <span class="n">data_df</span><span class="o">=</span><span class="n">ds_df</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">destpath</span><span class="o">=</span><span class="n">RAW_DATA_DIR</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rec_mgr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="n">ds_id</span><span class="o">=</span><span class="n">dataset_name</span><span class="p">,</span>
        <span class="n">src_url</span><span class="o">=</span><span class="n">ref_url</span><span class="p">,</span>
        <span class="n">download_url</span><span class="o">=</span><span class="n">formatted_url</span><span class="p">,</span>
        <span class="n">raw_ds_filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully imported </span><span class="si">{</span><span class="n">import_type</span><span class="si">}</span><span class="s2"> dataset from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DataManager.normalize_dataset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">normalize_dataset</span><span class="p">(</span><span class="n">ds_files</span><span class="p">,</span> <span class="n">conv_schema_fn</span><span class="p">,</span> <span class="n">output_fn</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Handles normalization of a third-party dataset to the schema used for training our models.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>ds_files</code></b>
                  (<code><span title="list">list</span>[<span title="str">str</span>]</code>)
              
              <div class="doc-md-description">
                <p>One or more dataset files to merge and normalize.</p>
              </div>
            </li>
            <li>
              <b><code>conv_schema_fn</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>The file name of the json conversion schema used.</p>
              </div>
            </li>
            <li>
              <b><code>output_fn</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>The output filename to be used.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="DataFrame">DataFrame</span></code>
              
              <div class="doc-md-description">
                <p>True if it exists, False if it does not.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">normalize_dataset</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">ds_files</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">conv_schema_fn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_fn</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handles normalization of a third-party dataset to the schema used for training our models.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ds_files : list[str]</span>
<span class="sd">        One or more dataset files to merge and normalize.</span>
<span class="sd">    conv_schema_fn : str</span>
<span class="sd">        The file name of the json conversion schema used.</span>
<span class="sd">    output_fn : str</span>
<span class="sd">        The output filename to be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DataFrame</span>
<span class="sd">        True if it exists, False if it does not.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">ds_files</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_filepath</span><span class="p">((</span><span class="n">RAW_DATA_DIR</span> <span class="o">/</span> <span class="n">filename</span><span class="p">)):</span>
            <span class="n">err_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid filepath for file, </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">RAW_DATA_DIR</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">filename</span><span class="si">}</span><span class="s2">].&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid_filepath</span><span class="p">(</span><span class="n">NORM_SCHEMA_DIR</span> <span class="o">/</span> <span class="n">conv_schema_fn</span><span class="p">):</span>
        <span class="n">err_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Normalization schema file, </span><span class="si">{</span><span class="n">conv_schema_fn</span><span class="si">}</span><span class="s2">, does not exist.&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output_fn</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_fn</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">err_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid output filename&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">normalized_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalizer</span><span class="o">.</span><span class="n">normalize_datasets</span><span class="p">(</span>
            <span class="n">files</span><span class="o">=</span><span class="n">ds_files</span><span class="p">,</span> <span class="n">cv_path</span><span class="o">=</span><span class="n">NORM_SCHEMA_DIR</span> <span class="o">/</span> <span class="n">conv_schema_fn</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">err_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to normalize file(s) - </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_store_data</span><span class="p">(</span><span class="n">normalized_df</span><span class="p">,</span> <span class="n">output_fn</span><span class="p">,</span> <span class="n">INTERIM_DATA_DIR</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">ds_files</span><span class="p">:</span>
        <span class="n">row_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_mgr</span><span class="o">.</span><span class="n">get_entry_by_raw_fn</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rec_mgr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="n">ds_id</span><span class="o">=</span><span class="n">row_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">src_url</span><span class="o">=</span><span class="n">row_vals</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">download_url</span><span class="o">=</span><span class="n">row_vals</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">raw_ds_filename</span><span class="o">=</span><span class="n">row_vals</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="n">normalization_schema_filename</span><span class="o">=</span><span class="n">conv_schema_fn</span><span class="p">,</span>
            <span class="n">normalized_ds_filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_fn</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully normalized dataset files [</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ds_files</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">normalized_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DataManager.prepare_and_preprocess_dataset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_and_preprocess_dataset</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;NLPinitiative_Master_Dataset.csv&#39;</span><span class="p">,</span> <span class="n">srcdir</span><span class="o">=</span><span class="n">PROCESSED_DATA_DIR</span><span class="p">,</span> <span class="n">bin_model_type</span><span class="o">=</span><span class="n">DEF_MODEL</span><span class="p">,</span> <span class="n">ml_model_type</span><span class="o">=</span><span class="n">DEF_MODEL</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Preprocesses and tokenizes the specified dataset.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>filename</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;NLPinitiative_Master_Dataset.csv&#39;</code>
)
              
              <div class="doc-md-description">
                <p>The file name of the file to be loaded and processed (default is 'NLPinitiative_Master_Dataset.csv').</p>
              </div>
            </li>
            <li>
              <b><code>srcdir</code></b>
                  (<code><span title="pathlib.Path">Path</span></code>, default:
                      <code><span title="nlpinitiative.config.PROCESSED_DATA_DIR">PROCESSED_DATA_DIR</span></code>
)
              
              <div class="doc-md-description">
                <p>The source directory of the file to be processed (default is data/processed).</p>
              </div>
            </li>
            <li>
              <b><code>bin_model_type</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code><span title="nlpinitiative.config.DEF_MODEL">DEF_MODEL</span></code>
)
              
              <div class="doc-md-description">
                <p>The binary classification base model type (default is the DEF_MODEL defined in the nlpinitiative/config.py file).</p>
              </div>
            </li>
            <li>
              <b><code>ml_model_type</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code><span title="nlpinitiative.config.DEF_MODEL">DEF_MODEL</span></code>
)
              
              <div class="doc-md-description">
                <p>The multilabel regression base model type (default is the DEF_MODEL defined in the nlpinitiative/config.py file).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="tuple">tuple</span>[<a class="autorefs autorefs-internal" title="DatasetContainer (nlpinitiative.data_preparation.data_management.DatasetContainer)" href="#nlpinitiative.data_preparation.data_management.DatasetContainer">DatasetContainer</a>, <a class="autorefs autorefs-internal" title="DatasetContainer (nlpinitiative.data_preparation.data_management.DatasetContainer)" href="#nlpinitiative.data_preparation.data_management.DatasetContainer">DatasetContainer</a>]</code>
              
              <div class="doc-md-description">
                <p>Two data container objects consisting of the raw dataset, encoded dataset, metadata and tokenizer for training binary and multilabel models.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepare_and_preprocess_dataset</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;NLPinitiative_Master_Dataset.csv&quot;</span><span class="p">,</span>
    <span class="n">srcdir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">PROCESSED_DATA_DIR</span><span class="p">,</span>
    <span class="n">bin_model_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEF_MODEL</span><span class="p">,</span>
    <span class="n">ml_model_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEF_MODEL</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Preprocesses and tokenizes the specified dataset.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str, optional</span>
<span class="sd">        The file name of the file to be loaded and processed (default is &#39;NLPinitiative_Master_Dataset.csv&#39;).</span>
<span class="sd">    srcdir : Path, optional</span>
<span class="sd">        The source directory of the file to be processed (default is data/processed).</span>
<span class="sd">    bin_model_type : str, optional</span>
<span class="sd">        The binary classification base model type (default is the DEF_MODEL defined in the nlpinitiative/config.py file).</span>
<span class="sd">    ml_model_type : str, optional</span>
<span class="sd">        The multilabel regression base model type (default is the DEF_MODEL defined in the nlpinitiative/config.py file).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple[DatasetContainer, DatasetContainer]</span>
<span class="sd">        Two data container objects consisting of the raw dataset, encoded dataset, metadata and tokenizer for training binary and multilabel models.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">raw_dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">dataset_from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">srcdir</span><span class="p">)</span>
    <span class="n">bin_ds</span><span class="p">,</span> <span class="n">ml_ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">bin_ml_dataset_split</span><span class="p">(</span><span class="n">raw_dataset</span><span class="p">)</span>

    <span class="n">bin_ds_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">get_dataset_metadata</span><span class="p">(</span><span class="n">bin_ds</span><span class="p">)</span>
    <span class="n">bin_tkzr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">get_tokenizer</span><span class="p">(</span><span class="n">bin_model_type</span><span class="p">)</span>
    <span class="n">bin_encoded_ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">bin_ds</span><span class="p">,</span> <span class="n">bin_ds_metadata</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">],</span> <span class="n">bin_tkzr</span><span class="p">)</span>
    <span class="n">bin_data_obj</span> <span class="o">=</span> <span class="n">DatasetContainer</span><span class="p">(</span><span class="n">bin_ds</span><span class="p">,</span> <span class="n">bin_encoded_ds</span><span class="p">,</span> <span class="n">bin_ds_metadata</span><span class="p">,</span> <span class="n">bin_tkzr</span><span class="p">)</span>

    <span class="n">ml_ds_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">get_dataset_metadata</span><span class="p">(</span><span class="n">bin_ds</span><span class="p">)</span>
    <span class="n">ml_tkzr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">get_tokenizer</span><span class="p">(</span><span class="n">ml_model_type</span><span class="p">)</span>
    <span class="n">ml_encoded_ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">ml_ds</span><span class="p">,</span> <span class="n">ml_ds_metadata</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">],</span> <span class="n">ml_tkzr</span><span class="p">)</span>
    <span class="n">ml_data_obj</span> <span class="o">=</span> <span class="n">DatasetContainer</span><span class="p">(</span><span class="n">ml_ds</span><span class="p">,</span> <span class="n">ml_encoded_ds</span><span class="p">,</span> <span class="n">ml_ds_metadata</span><span class="p">,</span> <span class="n">ml_tkzr</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">bin_data_obj</span><span class="p">,</span> <span class="n">ml_data_obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DataManager.pull_dataset_repo" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pull_dataset_repo</span><span class="p">(</span><span class="n">token</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Pulls the data directory from the linked Hugging Face Dataset Repository.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>token</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>A Hugging Face token with read/write access privileges to allow importing the data.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pull_dataset_repo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pulls the data directory from the linked Hugging Face Dataset Repository.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    token : str</span>
<span class="sd">        A Hugging Face token with read/write access privileges to allow importing the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hfh</span><span class="o">.</span><span class="n">snapshot_download</span><span class="p">(</span>
            <span class="n">repo_id</span><span class="o">=</span><span class="n">DATASET_REPO</span><span class="p">,</span> <span class="n">repo_type</span><span class="o">=</span><span class="s2">&quot;dataset&quot;</span><span class="p">,</span> <span class="n">local_dir</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">token</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DataManager.push_dataset_dir" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">push_dataset_dir</span><span class="p">(</span><span class="n">token</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Pushes the data directory (all dataset information) to the linked Hugging Face Dataset Repository.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>token</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>A Hugging Face token with read/write access privileges to allow importing the data.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">push_dataset_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pushes the data directory (all dataset information) to the linked Hugging Face Dataset Repository.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    token : str</span>
<span class="sd">        A Hugging Face token with read/write access privileges to allow importing the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hfh</span><span class="o">.</span><span class="n">upload_folder</span><span class="p">(</span>
            <span class="n">repo_id</span><span class="o">=</span><span class="n">DATASET_REPO</span><span class="p">,</span> <span class="n">repo_type</span><span class="o">=</span><span class="s2">&quot;dataset&quot;</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">token</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DataManager.remove_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Removes the specified file.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>filename</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>The name of the file.</p>
              </div>
            </li>
            <li>
              <b><code>path</code></b>
                  (<code><span title="pathlib.Path">Path</span></code>)
              
              <div class="doc-md-description">
                <p>The path to the file.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes the specified file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        The name of the file.</span>
<span class="sd">    path : Path</span>
<span class="sd">        The path to the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="n">filename</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="n">filename</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully removed file, </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to remove file, </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File, </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">, does not exist.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="nlpinitiative.data_preparation.data_management.DatasetContainer" class="doc doc-heading">
            <code>DatasetContainer</code>


</h3>


    <div class="doc doc-contents ">


        <p>A class used for organizing dataset information used within model training.</p>







              <details class="quote">
                <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DatasetContainer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class used for organizing dataset information used within model training.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="n">DatasetDict</span><span class="p">,</span>
        <span class="n">encoded_ds</span><span class="p">:</span> <span class="n">DatasetDict</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">tokenizer</span><span class="p">:</span> <span class="n">PreTrainedTokenizer</span> <span class="o">|</span> <span class="n">PreTrainedTokenizerFast</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constuctor for instantiating DatasetContainer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset : DatasetDict</span>
<span class="sd">            The raw dataset (before tokenization).</span>
<span class="sd">        encoded_ds : DatasetDict</span>
<span class="sd">            The encoded dataset.</span>
<span class="sd">        metadata : dict</span>
<span class="sd">            The metadata associated with the dataset.</span>
<span class="sd">        tokenizer : PreTrainedTokenizer | PreTrainedTokenizerFast</span>
<span class="sd">            The tokenizer used for tokenizing the dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_raw_dataset</span> <span class="o">=</span> <span class="n">dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_encoded_dataset</span> <span class="o">=</span> <span class="n">encoded_ds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lbl2idx</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;lbl2idx&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_idx2lbl</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;idx2lbl&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tkzr</span> <span class="o">=</span> <span class="n">tokenizer</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">raw_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The unencoded dataset.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raw_dataset</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">encoded_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The encoded/tokenized dataset.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encoded_dataset</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The labels used within the dataset.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lbl2idx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Dict for mapping label indices to the label names.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lbl2idx</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">idx2lbl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Dict for mapping label names to the label indices.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idx2lbl</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The tokenizer for the dataset.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkzr</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="nlpinitiative.data_preparation.data_management.DatasetContainer.encoded_dataset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">encoded_dataset</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The encoded/tokenized dataset.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="nlpinitiative.data_preparation.data_management.DatasetContainer.idx2lbl" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">idx2lbl</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Dict for mapping label names to the label indices.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="nlpinitiative.data_preparation.data_management.DatasetContainer.labels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">labels</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The labels used within the dataset.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="nlpinitiative.data_preparation.data_management.DatasetContainer.lbl2idx" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lbl2idx</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Dict for mapping label indices to the label names.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="nlpinitiative.data_preparation.data_management.DatasetContainer.raw_dataset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">raw_dataset</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The unencoded dataset.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="nlpinitiative.data_preparation.data_management.DatasetContainer.tokenizer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tokenizer</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The tokenizer for the dataset.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DatasetContainer.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">encoded_ds</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Constuctor for instantiating DatasetContainer.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>dataset</code></b>
                  (<code><span title="datasets.DatasetDict">DatasetDict</span></code>)
              
              <div class="doc-md-description">
                <p>The raw dataset (before tokenization).</p>
              </div>
            </li>
            <li>
              <b><code>encoded_ds</code></b>
                  (<code><span title="datasets.DatasetDict">DatasetDict</span></code>)
              
              <div class="doc-md-description">
                <p>The encoded dataset.</p>
              </div>
            </li>
            <li>
              <b><code>metadata</code></b>
                  (<code><span title="dict">dict</span></code>)
              
              <div class="doc-md-description">
                <p>The metadata associated with the dataset.</p>
              </div>
            </li>
            <li>
              <b><code>tokenizer</code></b>
                  (<code><span title="transformers.PreTrainedTokenizer">PreTrainedTokenizer</span> | <span title="transformers.PreTrainedTokenizerFast">PreTrainedTokenizerFast</span></code>)
              
              <div class="doc-md-description">
                <p>The tokenizer used for tokenizing the dataset.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="n">DatasetDict</span><span class="p">,</span>
    <span class="n">encoded_ds</span><span class="p">:</span> <span class="n">DatasetDict</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">tokenizer</span><span class="p">:</span> <span class="n">PreTrainedTokenizer</span> <span class="o">|</span> <span class="n">PreTrainedTokenizerFast</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constuctor for instantiating DatasetContainer.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dataset : DatasetDict</span>
<span class="sd">        The raw dataset (before tokenization).</span>
<span class="sd">    encoded_ds : DatasetDict</span>
<span class="sd">        The encoded dataset.</span>
<span class="sd">    metadata : dict</span>
<span class="sd">        The metadata associated with the dataset.</span>
<span class="sd">    tokenizer : PreTrainedTokenizer | PreTrainedTokenizerFast</span>
<span class="sd">        The tokenizer used for tokenizing the dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_raw_dataset</span> <span class="o">=</span> <span class="n">dataset</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_encoded_dataset</span> <span class="o">=</span> <span class="n">encoded_ds</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_lbl2idx</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;lbl2idx&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_idx2lbl</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;idx2lbl&quot;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tkzr</span> <span class="o">=</span> <span class="n">tokenizer</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="nlpinitiative.data_preparation.data_management.DatasetRecordManager" class="doc doc-heading">
            <code>DatasetRecordManager</code>


</h3>


    <div class="doc doc-contents ">


        <p>A class for managing and maintaining a record of the datasets imported and used for model training.</p>







              <details class="quote">
                <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DatasetRecordManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class for managing and maintaining a record of the datasets imported and used for model training.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor for instantiating a DatasetRecordManager object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_dataset_record</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_dataset_record</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads the dataset record into a Pandas Dataframe.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DataFrame</span>
<span class="sd">            The record of datasets as a DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="s2">&quot;dataset_record.csv&quot;</span><span class="p">):</span>
            <span class="n">ds_rec_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="o">=</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="s2">&quot;dataset_record.csv&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ds_rec_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
                    <span class="s2">&quot;Dataset ID&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Dataset Reference URL&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Dataset Download URL&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Raw Dataset Filename&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Conversion Schema Filename&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Converted Filename&quot;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">ds_rec_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="s2">&quot;dataset_record.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ds_rec_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save_ds_record</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Faciliates saving the current state of the dataset record as a csv file.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="s2">&quot;dataset_record.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dataset_src_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if a dataset record exists with the specified URL.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        src_url : str</span>
<span class="sd">            The source/reference URL of the dataset.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the record exists, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">[</span><span class="s2">&quot;Dataset Reference URL&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">src_url</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_ds_record_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a copy of the dataset record dataframe</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DataFrame</span>
<span class="sd">            A copy of the record as a Pandas DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ds_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">src_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">download_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">raw_ds_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">normalization_schema_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">normalized_ds_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a new dataset record or updates an existing record.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ds_id : str</span>
<span class="sd">            The name/id of the dataset (used for tracking purposes).</span>
<span class="sd">        src_url : str, optional</span>
<span class="sd">            The source or reference URL for an imported dataset (default is None).</span>
<span class="sd">        download_url : str, optional</span>
<span class="sd">            The download URL of the dataset (default is None).</span>
<span class="sd">        raw_ds_filename : str, optional</span>
<span class="sd">            The file name of the raw (non-normalized) dataset (default is None).</span>
<span class="sd">        normalization_schema_filename : str, optional</span>
<span class="sd">            The file name of the conversion schema used to normalize the dataset (default is None).</span>
<span class="sd">        normalized_ds_filename : str, optional</span>
<span class="sd">            The file name of the normalized version of the dataset (default is None).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ds_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;Dataset ID&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">ds_id</span><span class="p">],</span>
                    <span class="s2">&quot;Dataset Reference URL&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">src_url</span><span class="p">],</span>
                    <span class="s2">&quot;Dataset Download URL&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">download_url</span><span class="p">],</span>
                    <span class="s2">&quot;Raw Dataset Filename&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">raw_ds_filename</span><span class="p">],</span>
                    <span class="s2">&quot;Conversion Schema Filename&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">normalization_schema_filename</span><span class="p">],</span>
                    <span class="s2">&quot;Converted Filename&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">normalized_ds_filename</span><span class="p">],</span>
                <span class="p">}</span>
            <span class="p">)</span>

            <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">,</span> <span class="n">new_df</span><span class="p">])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
                <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Dataset ID&quot;</span><span class="p">,</span> <span class="s2">&quot;Dataset Reference URL&quot;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;last&quot;</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span> <span class="o">=</span> <span class="n">temp_df</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_ds_record</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Facilitates removal of a dataset record.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ds_id : str</span>
<span class="sd">            The name/id of the dataset to be removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ds_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">[</span><span class="s2">&quot;Dataset ID&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ds_id</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_ds_record</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_entry_by_raw_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieves the raw file name of the specified dataset record.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str</span>
<span class="sd">            The file name of the normalized version of the dataset.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Exception</span>
<span class="sd">            If the method failed to retrieve the specified record.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The file name of the non-normalized version of the dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">[</span><span class="s2">&quot;Raw Dataset Filename&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">filename</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">row</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">err_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to retrieve row of Dataset Record - </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DatasetRecordManager.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Constructor for instantiating a DatasetRecordManager object.</p>


            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor for instantiating a DatasetRecordManager object.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_dataset_record</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DatasetRecordManager.dataset_src_exists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dataset_src_exists</span><span class="p">(</span><span class="n">src_url</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Checks if a dataset record exists with the specified URL.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>src_url</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>The source/reference URL of the dataset.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="bool">bool</span></code>
              
              <div class="doc-md-description">
                <p>True if the record exists, False otherwise.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dataset_src_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if a dataset record exists with the specified URL.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    src_url : str</span>
<span class="sd">        The source/reference URL of the dataset.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if the record exists, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">[</span><span class="s2">&quot;Dataset Reference URL&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">src_url</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DatasetRecordManager.get_ds_record_copy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_ds_record_copy</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns a copy of the dataset record dataframe</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="DataFrame">DataFrame</span></code>
              
              <div class="doc-md-description">
                <p>A copy of the record as a Pandas DataFrame.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_ds_record_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a copy of the dataset record dataframe</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DataFrame</span>
<span class="sd">        A copy of the record as a Pandas DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DatasetRecordManager.get_entry_by_raw_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_entry_by_raw_fn</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Retrieves the raw file name of the specified dataset record.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>filename</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>The file name of the normalized version of the dataset.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="Exception">Exception</span></code>
              
              <div class="doc-md-description">
                <p>If the method failed to retrieve the specified record.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="str">str</span></code>
              
              <div class="doc-md-description">
                <p>The file name of the non-normalized version of the dataset.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_entry_by_raw_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves the raw file name of the specified dataset record.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        The file name of the normalized version of the dataset.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    Exception</span>
<span class="sd">        If the method failed to retrieve the specified record.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The file name of the non-normalized version of the dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">row</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">[</span><span class="s2">&quot;Raw Dataset Filename&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">filename</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">row</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">err_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to retrieve row of Dataset Record - </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DatasetRecordManager.load_dataset_record" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_dataset_record</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Loads the dataset record into a Pandas Dataframe.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="DataFrame">DataFrame</span></code>
              
              <div class="doc-md-description">
                <p>The record of datasets as a DataFrame.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_dataset_record</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads the dataset record into a Pandas Dataframe.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DataFrame</span>
<span class="sd">        The record of datasets as a DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="s2">&quot;dataset_record.csv&quot;</span><span class="p">):</span>
        <span class="n">ds_rec_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="o">=</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="s2">&quot;dataset_record.csv&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ds_rec_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;Dataset ID&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Dataset Reference URL&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Dataset Download URL&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Raw Dataset Filename&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Conversion Schema Filename&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Converted Filename&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">ds_rec_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="s2">&quot;dataset_record.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds_rec_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DatasetRecordManager.remove_entry" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_entry</span><span class="p">(</span><span class="n">ds_id</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Facilitates removal of a dataset record.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>ds_id</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>The name/id of the dataset to be removed.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Facilitates removal of a dataset record.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ds_id : str</span>
<span class="sd">        The name/id of the dataset to be removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">ds_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">[</span><span class="s2">&quot;Dataset ID&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ds_id</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_ds_record</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DatasetRecordManager.save_ds_record" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_ds_record</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Faciliates saving the current state of the dataset record as a csv file.</p>


            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_ds_record</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Faciliates saving the current state of the dataset record as a csv file.&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="s2">&quot;dataset_record.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_management.DatasetRecordManager.update" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="n">ds_id</span><span class="p">,</span> <span class="n">src_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">download_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw_ds_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normalization_schema_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normalized_ds_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Adds a new dataset record or updates an existing record.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>ds_id</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>The name/id of the dataset (used for tracking purposes).</p>
              </div>
            </li>
            <li>
              <b><code>src_url</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>None</code>
)
              
              <div class="doc-md-description">
                <p>The source or reference URL for an imported dataset (default is None).</p>
              </div>
            </li>
            <li>
              <b><code>download_url</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>None</code>
)
              
              <div class="doc-md-description">
                <p>The download URL of the dataset (default is None).</p>
              </div>
            </li>
            <li>
              <b><code>raw_ds_filename</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>None</code>
)
              
              <div class="doc-md-description">
                <p>The file name of the raw (non-normalized) dataset (default is None).</p>
              </div>
            </li>
            <li>
              <b><code>normalization_schema_filename</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>None</code>
)
              
              <div class="doc-md-description">
                <p>The file name of the conversion schema used to normalize the dataset (default is None).</p>
              </div>
            </li>
            <li>
              <b><code>normalized_ds_filename</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>None</code>
)
              
              <div class="doc-md-description">
                <p>The file name of the normalized version of the dataset (default is None).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_management.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ds_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">src_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">download_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">raw_ds_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">normalization_schema_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">normalized_ds_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a new dataset record or updates an existing record.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ds_id : str</span>
<span class="sd">        The name/id of the dataset (used for tracking purposes).</span>
<span class="sd">    src_url : str, optional</span>
<span class="sd">        The source or reference URL for an imported dataset (default is None).</span>
<span class="sd">    download_url : str, optional</span>
<span class="sd">        The download URL of the dataset (default is None).</span>
<span class="sd">    raw_ds_filename : str, optional</span>
<span class="sd">        The file name of the raw (non-normalized) dataset (default is None).</span>
<span class="sd">    normalization_schema_filename : str, optional</span>
<span class="sd">        The file name of the conversion schema used to normalize the dataset (default is None).</span>
<span class="sd">    normalized_ds_filename : str, optional</span>
<span class="sd">        The file name of the normalized version of the dataset (default is None).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">ds_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;Dataset ID&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">ds_id</span><span class="p">],</span>
                <span class="s2">&quot;Dataset Reference URL&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">src_url</span><span class="p">],</span>
                <span class="s2">&quot;Dataset Download URL&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">download_url</span><span class="p">],</span>
                <span class="s2">&quot;Raw Dataset Filename&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">raw_ds_filename</span><span class="p">],</span>
                <span class="s2">&quot;Conversion Schema Filename&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">normalization_schema_filename</span><span class="p">],</span>
                <span class="s2">&quot;Converted Filename&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">normalized_ds_filename</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span><span class="p">,</span> <span class="n">new_df</span><span class="p">])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
            <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Dataset ID&quot;</span><span class="p">,</span> <span class="s2">&quot;Dataset Reference URL&quot;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;last&quot;</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rec_df</span> <span class="o">=</span> <span class="n">temp_df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_ds_record</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><hr />


<div class="doc doc-object doc-module">



<h2 id="nlpinitiative.data_preparation.data_normalize" class="doc doc-heading">
            <code>nlpinitiative.data_preparation.data_normalize</code>


</h2>

    <div class="doc doc-contents first">

        <p>Script file used for facillitating normalization of a third-party dataset(s) into
the format that we will utilize for training the model. This script can also handle
merging complimentary datasets (datasets that come from the same source that may have minor
differences in labeling scheme).</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="nlpinitiative.data_preparation.data_normalize.DataNormalizer" class="doc doc-heading">
            <code>DataNormalizer</code>


</h3>


    <div class="doc doc-contents ">


        <p>A class used to normalize datasets to the format utilized for model training.</p>







              <details class="quote">
                <summary>Source code in <code>nlpinitiative\data_preparation\data_normalize.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DataNormalizer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class used to normalize datasets to the format utilized for model training.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_merge_dataframes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">df1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">df2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">merge_col</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merges two Pandas DataFrames.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df1 : DataFrame</span>
<span class="sd">            DataFrame to be merged.</span>
<span class="sd">        df2 : DataFrame</span>
<span class="sd">            DataFrame to be merged.</span>
<span class="sd">        merge_col : str</span>
<span class="sd">            The column for which the DataFrames are to be merged on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DataFrame</span>
<span class="sd">            The resulting merged DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">merge_col</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_src_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a source file into a Pandas DataFrame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : Path</span>
<span class="sd">            The file path to the source file.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DataFrame</span>
<span class="sd">            The source file data in a DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_conv_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">:</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads the dataset conversion schema that will be used for normalizing a dataset.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : Path</span>
<span class="sd">            The file path to the JSON conversion schema.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict[str:str]</span>
<span class="sd">            The conversion schema as a JSON object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">normalize_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="n">cv_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads, merges and normalizes one or more datasets to the schema used for model training.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        files : list[Path]</span>
<span class="sd">            A list of dataset file paths that are to be merged and normalized.</span>
<span class="sd">        cv_path : Path</span>
<span class="sd">            The file path to the JSON conversion schema.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dataframe</span>
<span class="sd">            The normalized dataset(s) as a DataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">num_files</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
        <span class="n">src_df</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_files</span><span class="p">):</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_src_file</span><span class="p">(</span><span class="n">RAW_DATA_DIR</span> <span class="o">/</span> <span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">src_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">src_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_merge_dataframes</span><span class="p">(</span><span class="n">src_df</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">data_col_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">src_df</span> <span class="o">=</span> <span class="n">df</span>

        <span class="n">conv_scema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_conv_schema</span><span class="p">(</span><span class="n">cv_path</span><span class="p">)</span>
        <span class="n">data_col_name</span> <span class="o">=</span> <span class="n">conv_scema</span><span class="p">[</span><span class="s2">&quot;data_col&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">conv_scema</span><span class="p">[</span><span class="s2">&quot;mapping_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;many2many&quot;</span><span class="p">:</span>
            <span class="n">schema_cats</span> <span class="o">=</span> <span class="n">conv_scema</span><span class="p">[</span><span class="s2">&quot;column_mapping&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

            <span class="n">master_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span> <span class="n">columns</span><span class="o">=</span><span class="n">DATASET_COLS</span><span class="p">)</span>
            <span class="n">master_df</span><span class="p">[</span><span class="n">DATASET_COLS</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">src_df</span><span class="p">[</span><span class="n">data_col_name</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">schema_cats</span><span class="p">:</span>
                <span class="n">from_columns</span> <span class="o">=</span> <span class="n">conv_scema</span><span class="p">[</span><span class="s2">&quot;column_mapping&quot;</span><span class="p">][</span><span class="n">cat</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">from_columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">cat</span> <span class="o">==</span> <span class="n">DATASET_COLS</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">master_df</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">src_df</span><span class="p">[</span><span class="n">from_columns</span><span class="p">]</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Int64Dtype</span><span class="p">())</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">master_df</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">src_df</span><span class="p">[</span><span class="n">from_columns</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">master_df</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="n">cols</span> <span class="o">=</span> <span class="n">master_df</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;unnamed&quot;</span> <span class="ow">in</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                    <span class="n">master_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

            <span class="n">indices_to_purge</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">master_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="n">is_hate</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">DATASET_COLS</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">1</span>
                <span class="n">has_cat_values</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">CATEGORY_LABELS</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.0</span>

                <span class="k">if</span> <span class="n">is_hate</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_cat_values</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">is_hate</span> <span class="ow">and</span> <span class="n">has_cat_values</span><span class="p">:</span>
                    <span class="n">indices_to_purge</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

            <span class="n">master_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">master_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">indices_to_purge</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">source_column</span> <span class="o">=</span> <span class="n">conv_scema</span><span class="p">[</span><span class="s2">&quot;single_column_label&quot;</span><span class="p">]</span>
            <span class="n">cat_mapping</span> <span class="o">=</span> <span class="n">conv_scema</span><span class="p">[</span><span class="s2">&quot;column_mapping&quot;</span><span class="p">]</span>

            <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">src_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="n">row_data</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="n">text</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">data_col_name</span><span class="p">]</span>
                <span class="n">type_discr</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">source_column</span><span class="p">]</span>

                <span class="n">row_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
                <span class="n">row_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

                <span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">cat_mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">type_discr</span> <span class="ow">in</span> <span class="n">cat_mapping</span><span class="p">[</span><span class="n">cat</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">cat</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
                            <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">val_breakdown</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">cat_mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.0</span>
                        <span class="k">if</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">val_breakdown</span>
                        <span class="n">row_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

                    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_data</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="n">master_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">DATASET_COLS</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">master_df</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_normalize.DataNormalizer.normalize_datasets" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">normalize_datasets</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">cv_path</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Loads, merges and normalizes one or more datasets to the schema used for model training.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>files</code></b>
                  (<code><span title="list">list</span>[<span title="pathlib.Path">Path</span>]</code>)
              
              <div class="doc-md-description">
                <p>A list of dataset file paths that are to be merged and normalized.</p>
              </div>
            </li>
            <li>
              <b><code>cv_path</code></b>
                  (<code><span title="pathlib.Path">Path</span></code>)
              
              <div class="doc-md-description">
                <p>The file path to the JSON conversion schema.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="Dataframe">Dataframe</span></code>
              
              <div class="doc-md-description">
                <p>The normalized dataset(s) as a DataFrame.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_normalize.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">normalize_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">],</span> <span class="n">cv_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads, merges and normalizes one or more datasets to the schema used for model training.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    files : list[Path]</span>
<span class="sd">        A list of dataset file paths that are to be merged and normalized.</span>
<span class="sd">    cv_path : Path</span>
<span class="sd">        The file path to the JSON conversion schema.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Dataframe</span>
<span class="sd">        The normalized dataset(s) as a DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">num_files</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
    <span class="n">src_df</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_files</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_src_file</span><span class="p">(</span><span class="n">RAW_DATA_DIR</span> <span class="o">/</span> <span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">src_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">src_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_merge_dataframes</span><span class="p">(</span><span class="n">src_df</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">data_col_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">src_df</span> <span class="o">=</span> <span class="n">df</span>

    <span class="n">conv_scema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_conv_schema</span><span class="p">(</span><span class="n">cv_path</span><span class="p">)</span>
    <span class="n">data_col_name</span> <span class="o">=</span> <span class="n">conv_scema</span><span class="p">[</span><span class="s2">&quot;data_col&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">conv_scema</span><span class="p">[</span><span class="s2">&quot;mapping_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;many2many&quot;</span><span class="p">:</span>
        <span class="n">schema_cats</span> <span class="o">=</span> <span class="n">conv_scema</span><span class="p">[</span><span class="s2">&quot;column_mapping&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="n">master_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span> <span class="n">columns</span><span class="o">=</span><span class="n">DATASET_COLS</span><span class="p">)</span>
        <span class="n">master_df</span><span class="p">[</span><span class="n">DATASET_COLS</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">src_df</span><span class="p">[</span><span class="n">data_col_name</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">schema_cats</span><span class="p">:</span>
            <span class="n">from_columns</span> <span class="o">=</span> <span class="n">conv_scema</span><span class="p">[</span><span class="s2">&quot;column_mapping&quot;</span><span class="p">][</span><span class="n">cat</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">from_columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cat</span> <span class="o">==</span> <span class="n">DATASET_COLS</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">master_df</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">src_df</span><span class="p">[</span><span class="n">from_columns</span><span class="p">]</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Int64Dtype</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">master_df</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">src_df</span><span class="p">[</span><span class="n">from_columns</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">master_df</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">cols</span> <span class="o">=</span> <span class="n">master_df</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;unnamed&quot;</span> <span class="ow">in</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">master_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

        <span class="n">indices_to_purge</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">master_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">is_hate</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">DATASET_COLS</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="n">has_cat_values</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">CATEGORY_LABELS</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.0</span>

            <span class="k">if</span> <span class="n">is_hate</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_cat_values</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">is_hate</span> <span class="ow">and</span> <span class="n">has_cat_values</span><span class="p">:</span>
                <span class="n">indices_to_purge</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="n">master_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">master_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">indices_to_purge</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">source_column</span> <span class="o">=</span> <span class="n">conv_scema</span><span class="p">[</span><span class="s2">&quot;single_column_label&quot;</span><span class="p">]</span>
        <span class="n">cat_mapping</span> <span class="o">=</span> <span class="n">conv_scema</span><span class="p">[</span><span class="s2">&quot;column_mapping&quot;</span><span class="p">]</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">src_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">row_data</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">text</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">data_col_name</span><span class="p">]</span>
            <span class="n">type_discr</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">source_column</span><span class="p">]</span>

            <span class="n">row_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="n">row_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">cat_mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">type_discr</span> <span class="ow">in</span> <span class="n">cat_mapping</span><span class="p">[</span><span class="n">cat</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">cat</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
                        <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">val_breakdown</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">cat_mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="k">if</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">val_breakdown</span>
                    <span class="n">row_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_data</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="n">master_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">DATASET_COLS</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">master_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><hr />


<div class="doc doc-object doc-module">



<h2 id="nlpinitiative.data_preparation.data_process" class="doc doc-heading">
            <code>nlpinitiative.data_preparation.data_process</code>


</h2>

    <div class="doc doc-contents first">

        <p>Script file used for facillitating dataset preparation and preprocessing
for use in model training.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="nlpinitiative.data_preparation.data_process.DataProcessor" class="doc doc-heading">
            <code>DataProcessor</code>


</h3>


    <div class="doc doc-contents ">


        <p>A class used for performing preprocessing/tokenization.</p>







              <details class="quote">
                <summary>Source code in <code>nlpinitiative\data_preparation\data_process.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DataProcessor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class used for performing preprocessing/tokenization.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dataset_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">srcdir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">PROCESSED_DATA_DIR</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatasetDict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads a dataset from a specified file into a Dataset object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str</span>
<span class="sd">            The file name of the dataset to be loaded.</span>
<span class="sd">        srcdir : Path, optional</span>
<span class="sd">            The file path to the directory that the dataset is stored (default is data/processed).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        Exception</span>
<span class="sd">            If the file specified does not exist.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DatasetDict</span>
<span class="sd">            The loaded dataset as a DatasetDict object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">filename</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">srcdir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)):</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">ext</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span>
                <span class="n">ext</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">srcdir</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="n">TRAIN_TEST_SPLIT</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ds</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid file name or file path&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">bin_ml_dataset_split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">DatasetDict</span><span class="p">,</span> <span class="n">DatasetDict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forms train/test split for use in the binary classification and multilabel regression models training.</span>

<span class="sd">        Takes a loaded dataset and splits it into two separate datasets with the required corresponding</span>
<span class="sd">        labels (the binary model dataset will only have the DISCRIMINATORY column, while the multilabel</span>
<span class="sd">        regression model will only have the columns consisting of the discrimination categories). Additionally,</span>
<span class="sd">        the function will split the prepared datasets into a train/test split.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset : DatasetDict</span>
<span class="sd">            The dataset to be processed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DatasetDict</span>
<span class="sd">            The prepared binary model and multilabel model dataset objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">get_bin_ds</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">DatasetDict</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Prepares the binary model dataset.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            DatasetDict</span>
<span class="sd">                The prepared binary model dataset.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">train</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">CATEGORY_LABELS</span><span class="p">)</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">CATEGORY_LABELS</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">DatasetDict</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">train</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s2">&quot;DISCRIMINATORY&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">),</span>
                    <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="n">test</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s2">&quot;DISCRIMINATORY&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">),</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">get_ml_regr_ds</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">DatasetDict</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Prepares the multilabel model dataset.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            DatasetDict</span>
<span class="sd">                The prepared multilabel model dataset.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">combine_labels</span><span class="p">(</span><span class="n">ex_ds</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;Consolidates the mutiple dataset columns for categories into a single</span>
<span class="sd">                column consisting of a list of the category data.</span>

<span class="sd">                Parameters</span>
<span class="sd">                ----------</span>
<span class="sd">                ex_ds : DatasetDict</span>
<span class="sd">                    The multilabel dataset to be corrected.</span>

<span class="sd">                Returns</span>
<span class="sd">                -------</span>
<span class="sd">                DatasetDict</span>
<span class="sd">                    The corrected dataset.</span>
<span class="sd">                &quot;&quot;&quot;</span>

                <span class="n">ex_ds</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">ex_ds</span><span class="p">[</span><span class="s2">&quot;GENDER&quot;</span><span class="p">]),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">ex_ds</span><span class="p">[</span><span class="s2">&quot;RACE&quot;</span><span class="p">]),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">ex_ds</span><span class="p">[</span><span class="s2">&quot;SEXUALITY&quot;</span><span class="p">]),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">ex_ds</span><span class="p">[</span><span class="s2">&quot;DISABILITY&quot;</span><span class="p">]),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">ex_ds</span><span class="p">[</span><span class="s2">&quot;RELIGION&quot;</span><span class="p">]),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">ex_ds</span><span class="p">[</span><span class="s2">&quot;UNSPECIFIED&quot;</span><span class="p">]),</span>
                <span class="p">]</span>
                <span class="k">return</span> <span class="n">ex_ds</span>

            <span class="n">train</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">BINARY_LABELS</span><span class="p">)</span>
            <span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">combine_labels</span><span class="p">)</span>
            <span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">CATEGORY_LABELS</span><span class="p">)</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">BINARY_LABELS</span><span class="p">)</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">combine_labels</span><span class="p">)</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">CATEGORY_LABELS</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">DatasetDict</span><span class="p">({</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">train</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="n">test</span><span class="p">})</span>

        <span class="k">return</span> <span class="n">get_bin_ds</span><span class="p">(),</span> <span class="n">get_ml_regr_ds</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEF_MODEL</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates a tokenizer for the specified model type.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model_type : str, optional</span>
<span class="sd">            The model type for which the tokenizer is to be created.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PreTrainedTokenizer | PreTrainedTokenizerFast</span>
<span class="sd">            The tokenizer object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_type</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_dataset_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">DatasetDict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gathers metadata for the given dataset into a dict for use in model training.</span>

<span class="sd">        Extracts dataset metadata to include a list of the datasets labels, a dict mapping</span>
<span class="sd">        the labels to their respective indices and a dict mapping the indices to the respective label.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset : DatasetDict</span>
<span class="sd">            The dataset to retrieve metadata from.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            The metadata for the dataset within a dict object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">lbls</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">label</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">DATASET_COLS</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="p">]</span>
        <span class="n">lbl2idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">lbl</span><span class="p">:</span> <span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lbls</span><span class="p">)}</span>
        <span class="n">idx2lbl</span> <span class="o">=</span> <span class="p">{</span><span class="n">idx</span><span class="p">:</span> <span class="n">lbl</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lbls</span><span class="p">)}</span>

        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="n">lbls</span><span class="p">,</span> <span class="s2">&quot;lbl2idx&quot;</span><span class="p">:</span> <span class="n">lbl2idx</span><span class="p">,</span> <span class="s2">&quot;idx2lbl&quot;</span><span class="p">:</span> <span class="n">idx2lbl</span><span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">preprocess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">DatasetDict</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">tokenizer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatasetDict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Preprocesses and tokenizes a given dataset.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset : DatasetDict</span>
<span class="sd">            The dataset to to be preprocessed/tokenized.</span>
<span class="sd">        labels : list[str]</span>
<span class="sd">            The datasets labels.</span>
<span class="sd">        tokenizer : PreTrainedTokenizer | PreTrainedTokenizerFast</span>
<span class="sd">            The tokenizer used for tokenizing the dataset.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DatasetDict</span>
<span class="sd">            The preprocessed dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">preprocess_runner</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">DatasetDict</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Runner for performing tokenization.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            data : DatasetDict</span>
<span class="sd">                The dataset to to be tokenized.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            DatasetDict</span>
<span class="sd">                The tokenized dataset.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="k">return</span> <span class="n">tokenizer</span><span class="p">(</span>
                <span class="n">data</span><span class="p">[</span><span class="n">DATASET_COLS</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;max_length&quot;</span><span class="p">,</span> <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">128</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">labels</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">label</span>
                <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">DATASET_COLS</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tokenizer</span><span class="p">:</span>
            <span class="n">tokenizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tokenizer</span><span class="p">()</span>

        <span class="n">encoded_ds</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">preprocess_runner</span><span class="p">,</span> <span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">encoded_ds</span><span class="o">.</span><span class="n">set_format</span><span class="p">(</span><span class="s2">&quot;torch&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">encoded_ds</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_process.DataProcessor.bin_ml_dataset_split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bin_ml_dataset_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Forms train/test split for use in the binary classification and multilabel regression models training.</p>
<p>Takes a loaded dataset and splits it into two separate datasets with the required corresponding
labels (the binary model dataset will only have the DISCRIMINATORY column, while the multilabel
regression model will only have the columns consisting of the discrimination categories). Additionally,
the function will split the prepared datasets into a train/test split.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>dataset</code></b>
                  (<code><span title="datasets.DatasetDict">DatasetDict</span></code>)
              
              <div class="doc-md-description">
                <p>The dataset to be processed.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="datasets.DatasetDict">DatasetDict</span></code>
              
              <div class="doc-md-description">
                <p>The prepared binary model and multilabel model dataset objects.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_process.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bin_ml_dataset_split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">DatasetDict</span><span class="p">,</span> <span class="n">DatasetDict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Forms train/test split for use in the binary classification and multilabel regression models training.</span>

<span class="sd">    Takes a loaded dataset and splits it into two separate datasets with the required corresponding</span>
<span class="sd">    labels (the binary model dataset will only have the DISCRIMINATORY column, while the multilabel</span>
<span class="sd">    regression model will only have the columns consisting of the discrimination categories). Additionally,</span>
<span class="sd">    the function will split the prepared datasets into a train/test split.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dataset : DatasetDict</span>
<span class="sd">        The dataset to be processed.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DatasetDict</span>
<span class="sd">        The prepared binary model and multilabel model dataset objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_bin_ds</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">DatasetDict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepares the binary model dataset.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DatasetDict</span>
<span class="sd">            The prepared binary model dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">train</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">CATEGORY_LABELS</span><span class="p">)</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">CATEGORY_LABELS</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">DatasetDict</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">train</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s2">&quot;DISCRIMINATORY&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">),</span>
                <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="n">test</span><span class="o">.</span><span class="n">rename_column</span><span class="p">(</span><span class="s2">&quot;DISCRIMINATORY&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_ml_regr_ds</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">DatasetDict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepares the multilabel model dataset.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DatasetDict</span>
<span class="sd">            The prepared multilabel model dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">combine_labels</span><span class="p">(</span><span class="n">ex_ds</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Consolidates the mutiple dataset columns for categories into a single</span>
<span class="sd">            column consisting of a list of the category data.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            ex_ds : DatasetDict</span>
<span class="sd">                The multilabel dataset to be corrected.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            DatasetDict</span>
<span class="sd">                The corrected dataset.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">ex_ds</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">ex_ds</span><span class="p">[</span><span class="s2">&quot;GENDER&quot;</span><span class="p">]),</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">ex_ds</span><span class="p">[</span><span class="s2">&quot;RACE&quot;</span><span class="p">]),</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">ex_ds</span><span class="p">[</span><span class="s2">&quot;SEXUALITY&quot;</span><span class="p">]),</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">ex_ds</span><span class="p">[</span><span class="s2">&quot;DISABILITY&quot;</span><span class="p">]),</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">ex_ds</span><span class="p">[</span><span class="s2">&quot;RELIGION&quot;</span><span class="p">]),</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">ex_ds</span><span class="p">[</span><span class="s2">&quot;UNSPECIFIED&quot;</span><span class="p">]),</span>
            <span class="p">]</span>
            <span class="k">return</span> <span class="n">ex_ds</span>

        <span class="n">train</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">BINARY_LABELS</span><span class="p">)</span>
        <span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">combine_labels</span><span class="p">)</span>
        <span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">CATEGORY_LABELS</span><span class="p">)</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">BINARY_LABELS</span><span class="p">)</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">combine_labels</span><span class="p">)</span>
        <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">remove_columns</span><span class="p">(</span><span class="n">CATEGORY_LABELS</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">DatasetDict</span><span class="p">({</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">train</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="n">test</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">get_bin_ds</span><span class="p">(),</span> <span class="n">get_ml_regr_ds</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_process.DataProcessor.dataset_from_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dataset_from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">srcdir</span><span class="o">=</span><span class="n">PROCESSED_DATA_DIR</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Loads a dataset from a specified file into a Dataset object.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>filename</code></b>
                  (<code><span title="str">str</span></code>)
              
              <div class="doc-md-description">
                <p>The file name of the dataset to be loaded.</p>
              </div>
            </li>
            <li>
              <b><code>srcdir</code></b>
                  (<code><span title="pathlib.Path">Path</span></code>, default:
                      <code><span title="nlpinitiative.config.PROCESSED_DATA_DIR">PROCESSED_DATA_DIR</span></code>
)
              
              <div class="doc-md-description">
                <p>The file path to the directory that the dataset is stored (default is data/processed).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="Exception">Exception</span></code>
              
              <div class="doc-md-description">
                <p>If the file specified does not exist.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="datasets.DatasetDict">DatasetDict</span></code>
              
              <div class="doc-md-description">
                <p>The loaded dataset as a DatasetDict object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_process.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dataset_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">srcdir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">PROCESSED_DATA_DIR</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatasetDict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads a dataset from a specified file into a Dataset object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        The file name of the dataset to be loaded.</span>
<span class="sd">    srcdir : Path, optional</span>
<span class="sd">        The file path to the directory that the dataset is stored (default is data/processed).</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    Exception</span>
<span class="sd">        If the file specified does not exist.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DatasetDict</span>
<span class="sd">        The loaded dataset as a DatasetDict object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">filename</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">srcdir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)):</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">ext</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span>
            <span class="n">ext</span><span class="p">,</span> <span class="n">data_files</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">srcdir</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="n">TRAIN_TEST_SPLIT</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ds</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid file name or file path&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_process.DataProcessor.get_dataset_metadata" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_dataset_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Gathers metadata for the given dataset into a dict for use in model training.</p>
<p>Extracts dataset metadata to include a list of the datasets labels, a dict mapping
the labels to their respective indices and a dict mapping the indices to the respective label.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>dataset</code></b>
                  (<code><span title="datasets.DatasetDict">DatasetDict</span></code>)
              
              <div class="doc-md-description">
                <p>The dataset to retrieve metadata from.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="dict">dict</span></code>
              
              <div class="doc-md-description">
                <p>The metadata for the dataset within a dict object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_process.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_dataset_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">DatasetDict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gathers metadata for the given dataset into a dict for use in model training.</span>

<span class="sd">    Extracts dataset metadata to include a list of the datasets labels, a dict mapping</span>
<span class="sd">    the labels to their respective indices and a dict mapping the indices to the respective label.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dataset : DatasetDict</span>
<span class="sd">        The dataset to retrieve metadata from.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        The metadata for the dataset within a dict object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lbls</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">label</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">DATASET_COLS</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="p">]</span>
    <span class="n">lbl2idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">lbl</span><span class="p">:</span> <span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lbls</span><span class="p">)}</span>
    <span class="n">idx2lbl</span> <span class="o">=</span> <span class="p">{</span><span class="n">idx</span><span class="p">:</span> <span class="n">lbl</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lbls</span><span class="p">)}</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="n">lbls</span><span class="p">,</span> <span class="s2">&quot;lbl2idx&quot;</span><span class="p">:</span> <span class="n">lbl2idx</span><span class="p">,</span> <span class="s2">&quot;idx2lbl&quot;</span><span class="p">:</span> <span class="n">idx2lbl</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_process.DataProcessor.get_tokenizer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_tokenizer</span><span class="p">(</span><span class="n">model_type</span><span class="o">=</span><span class="n">DEF_MODEL</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generates a tokenizer for the specified model type.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>model_type</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code><span title="nlpinitiative.config.DEF_MODEL">DEF_MODEL</span></code>
)
              
              <div class="doc-md-description">
                <p>The model type for which the tokenizer is to be created.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="PreTrainedTokenizer">PreTrainedTokenizer</span> | <span title="PreTrainedTokenizerFast">PreTrainedTokenizerFast</span></code>
              
              <div class="doc-md-description">
                <p>The tokenizer object.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_process.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEF_MODEL</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a tokenizer for the specified model type.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model_type : str, optional</span>
<span class="sd">        The model type for which the tokenizer is to be created.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    PreTrainedTokenizer | PreTrainedTokenizerFast</span>
<span class="sd">        The tokenizer object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="nlpinitiative.data_preparation.data_process.DataProcessor.preprocess" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">preprocess</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Preprocesses and tokenizes a given dataset.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>dataset</code></b>
                  (<code><span title="datasets.DatasetDict">DatasetDict</span></code>)
              
              <div class="doc-md-description">
                <p>The dataset to to be preprocessed/tokenized.</p>
              </div>
            </li>
            <li>
              <b><code>labels</code></b>
                  (<code><span title="list">list</span>[<span title="str">str</span>]</code>)
              
              <div class="doc-md-description">
                <p>The datasets labels.</p>
              </div>
            </li>
            <li>
              <b><code>tokenizer</code></b>
                  (<code><span title="PreTrainedTokenizer">PreTrainedTokenizer</span> | <span title="PreTrainedTokenizerFast">PreTrainedTokenizerFast</span></code>)
              
              <div class="doc-md-description">
                <p>The tokenizer used for tokenizing the dataset.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="datasets.DatasetDict">DatasetDict</span></code>
              
              <div class="doc-md-description">
                <p>The preprocessed dataset.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>nlpinitiative\data_preparation\data_process.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">preprocess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">DatasetDict</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">tokenizer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatasetDict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Preprocesses and tokenizes a given dataset.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dataset : DatasetDict</span>
<span class="sd">        The dataset to to be preprocessed/tokenized.</span>
<span class="sd">    labels : list[str]</span>
<span class="sd">        The datasets labels.</span>
<span class="sd">    tokenizer : PreTrainedTokenizer | PreTrainedTokenizerFast</span>
<span class="sd">        The tokenizer used for tokenizing the dataset.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DatasetDict</span>
<span class="sd">        The preprocessed dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">preprocess_runner</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">DatasetDict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Runner for performing tokenization.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : DatasetDict</span>
<span class="sd">            The dataset to to be tokenized.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DatasetDict</span>
<span class="sd">            The tokenized dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">tokenizer</span><span class="p">(</span>
            <span class="n">data</span><span class="p">[</span><span class="n">DATASET_COLS</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;max_length&quot;</span><span class="p">,</span> <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">128</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">labels</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">label</span>
            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">DATASET_COLS</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">tokenizer</span><span class="p">:</span>
        <span class="n">tokenizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tokenizer</span><span class="p">()</span>

    <span class="n">encoded_ds</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">preprocess_runner</span><span class="p">,</span> <span class="n">batched</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">encoded_ds</span><span class="o">.</span><span class="n">set_format</span><span class="p">(</span><span class="s2">&quot;torch&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">encoded_ds</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><hr />
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../notebooks/Inference_Demo/" class="btn btn-neutral float-left" title="Model Inference"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../model-management/" class="btn btn-neutral float-right" title="Model Training, Evaluation and Inference">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../notebooks/Inference_Demo/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../model-management/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
